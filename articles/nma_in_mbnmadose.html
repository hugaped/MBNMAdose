<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Class effect NMA analysis using MBNMAdose • MBNMAdose</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Class effect NMA analysis using MBNMAdose">
<meta property="og:description" content="MBNMAdose">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MBNMAdose</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/consistencychecking-3.html">MBNMAdose: Checking for consistency</a>
    </li>
    <li>
      <a href="../articles/dataexploration-1.html">MBNMAdose: Exploring the data</a>
    </li>
    <li>
      <a href="../articles/mbnmadose-overview.html">MBNMAdose: Package Overview</a>
    </li>
    <li>
      <a href="../articles/metaregression-6.html">MBNMAdose: Perform Network Meta-Regression</a>
    </li>
    <li>
      <a href="../articles/nma_in_mbnmadose.html">Class effect NMA analysis using MBNMAdose</a>
    </li>
    <li>
      <a href="../articles/outputs-4.html">MBNMAdose outputs: Relative effects, forest plots and rankings</a>
    </li>
    <li>
      <a href="../articles/predictions-5.html">MBNMAdose: Calculating model predictions</a>
    </li>
    <li>
      <a href="../articles/runmbnmadose-2.html">MBNMAdose: Perform a Model-Based Network Meta-Analysis (MBNMA)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Class effect NMA analysis using MBNMAdose</h1>
            
      
      
      <div class="hidden name"><code>nma_in_mbnmadose.Rmd</code></div>

    </div>

    
    
<p>Although <code>MBNMAdose</code> is intended to be used for
dose-response Model-Based Network Meta-Analysis (MBNMA), it can also be
adapted to perform standard Network Meta-Analysis (NMA), and this allows
users to take advantage of some of the additional features of
<code>MBNMAdose</code>, such as modelling class effects, for use in
standard NMA. As well as fitting class effect models,
<code>MBNMAdose</code> also allows for nodes-splitting to check for
consistency in these models.</p>
<p>To illustrate how this can be done we will use a dataset of inhaled
medications for Chronic Obstructive Pulmonary Disease (COPD) from the
<code>netmeta</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/guido-s/netmeta" class="external-link">netmeta</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: meta</span></span>
<span><span class="co">#&gt; Loading required package: metadat</span></span>
<span><span class="co">#&gt; Loading 'meta' package (version 7.0-0).</span></span>
<span><span class="co">#&gt; Type 'help(meta)' for a brief overview.</span></span>
<span><span class="co">#&gt; Readers of 'Meta-Analysis with R (Use R!)' should install</span></span>
<span><span class="co">#&gt; older version of 'meta' package: https://tinyurl.com/dt4y5drs</span></span>
<span><span class="co">#&gt; Loading 'netmeta' package (version 2.9-0).</span></span>
<span><span class="co">#&gt; Type 'help("netmeta-package")' for a brief overview.</span></span>
<span><span class="co">#&gt; Readers of 'Meta-Analysis with R (Use R!)' should install</span></span>
<span><span class="co">#&gt; older version of 'netmeta' package: https://tinyurl.com/kyz6wjbb</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Dong2013"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename column names to match those used in MBNMAdose</span></span>
<span><span class="va">Dong2013</span> <span class="op">&lt;-</span> <span class="va">Dong2013</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">rename</span><span class="op">(</span>studyID <span class="op">=</span> <span class="va">id</span>, r <span class="op">=</span> <span class="va">death</span>, n <span class="op">=</span> <span class="va">randomized</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="performing-standard-nma-using-mbnma-run">Performing standard NMA using <code>mbnma.run()</code><a class="anchor" aria-label="anchor" href="#performing-standard-nma-using-mbnma-run"></a>
</h2>
<p>The simplest use is in a network that includes a placebo treatment.
In this dataset we do not have any dose-response information, so there
is no value in performing a MBNMA. However, if we assume that every
active treatment in the network is a separate “agent” with a dose of 1,
and that the Placebo treatment has a dose of 0, then we can use the data
in <code>MBNMAdose</code>, and by modelling a linear dose-response
function we estimate parameters that are identical to a standard NMA
model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define agents and assign a dose of 1 to all agents</span></span>
<span><span class="va">Dong2013</span> <span class="op">&lt;-</span> <span class="va">Dong2013</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>agent <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">agent</span> <span class="op">==</span> <span class="st">"Placebo"</span> <span class="op">~</span> <span class="fl">0</span>, <span class="va">agent</span> <span class="op">!=</span> <span class="st">"Placebo"</span> <span class="op">~</span></span>
<span>        <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that if there is an intervention within the dataset that has
been administered at multiple doses, you can force the dataset to be
analysed either as a “split” network (in which different doses are
assumed to have independent effects) by assigning each of them a
separate <code>agent</code> name (e.g. “warfarinlow”, “warfarinhigh”),
or as a “lumped” network (in which different doses are assumed to have
the same effect) by simply assigning both doses a dose of 1. Further
details of “lumping” and “splitting” and the implications of these
assumptions can be found in <span class="citation">[@pedder2021cons]</span>.</p>
<p>Once we have reassigned the doses within the dataset we can create an
<code>"mbnma.network"</code> object and create a network plot:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.network.html">mbnma.network</a></span><span class="op">(</span><span class="va">Dong2013</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Description: Network </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Number of studies: 41 </span></span>
<span><span class="co">#&gt; Number of treatments: 6 </span></span>
<span><span class="co">#&gt; Number of agents: 6 </span></span>
<span><span class="co">#&gt; Median (min, max) doses per agent (incl placebo): 2 (2, 2)</span></span>
<span><span class="co">#&gt; Agent-level network is <span style="color: #00BB00; font-weight: bold;">CONNECTED</span><span style="font-weight: bold;"> </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Ttreatment-level network is <span style="color: #00BB00; font-weight: bold;">CONNECTED</span><span style="font-weight: bold;"> </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span></span></code></pre></div>
<p><img src="nma_in_mbnmadose_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>We can then use a linear dose-response MBNMA to analyse the data. The
coefficients for the linear slope of the dose-response function are
mathematically equivalent to the basic treatment effect parameters
estimated in a standard NMA. Note that the results are equivalent in
both models (allowing for Monte-Carlo error from the MCMC sampling). The
only difference is that the placebo parameter (<code>beta.1[1]</code>)
that is equal to zero is not given in the output.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nma.linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.run.html">mbnma.run</a></span><span class="op">(</span><span class="va">network</span>, fun <span class="op">=</span> <span class="fu"><a href="../reference/dpoly.html">dpoly</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, n.iter <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="co">#&gt; `likelihood` not given by user - set to `binomial` based on data provided</span></span>
<span><span class="co">#&gt; `link` not given by user - set to `logit` based on assigned value for `likelihood`</span></span>
<span><span class="co">#&gt; module glm loaded</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">nma.linear</span><span class="op">)</span></span>
<span><span class="co">#&gt; Inference for Bugs model at "/tmp/RtmpCXN5rB/file1ee5296ffae5", fit using jags,</span></span>
<span><span class="co">#&gt;  3 chains, each with 50000 iterations (first 25000 discarded), n.thin = 25</span></span>
<span><span class="co">#&gt;  n.sims = 3000 iterations saved</span></span>
<span><span class="co">#&gt;           mu.vect  sd.vect    2.5%     25%     50%     75%   97.5%  Rhat n.eff</span></span>
<span><span class="co">#&gt; beta.1[2]   0.028    0.084  -0.143  -0.029   0.028   0.087   0.190 1.001  2400</span></span>
<span><span class="co">#&gt; beta.1[3]  -0.076    0.083  -0.240  -0.130  -0.074  -0.020   0.085 1.002  1400</span></span>
<span><span class="co">#&gt; beta.1[4]  -0.229    0.090  -0.405  -0.291  -0.229  -0.170  -0.053 1.003   710</span></span>
<span><span class="co">#&gt; beta.1[5]  -0.086    0.064  -0.210  -0.129  -0.086  -0.043   0.039 1.001  2600</span></span>
<span><span class="co">#&gt; beta.1[6]   0.413    0.184   0.045   0.288   0.415   0.538   0.768 1.006   360</span></span>
<span><span class="co">#&gt; totresdev 152.336 1263.241  92.384 103.079 109.445 116.670 132.588 1.005   450</span></span>
<span><span class="co">#&gt; deviance  458.036 1263.241 398.084 408.779 415.145 422.370 438.288 1.001  3000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor (at convergence, Rhat=1).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIC info (using the rule, pD = var(deviance)/2)</span></span>
<span><span class="co">#&gt; pD = 41.8 and DIC = 456.9</span></span>
<span><span class="co">#&gt; DIC is an estimate of expected predictive error (lower deviance is better).</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nma.run.html">nma.run</a></span><span class="op">(</span><span class="va">network</span>, n.iter <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">nma</span><span class="op">)</span></span>
<span><span class="co">#&gt; $jagsresult</span></span>
<span><span class="co">#&gt; Inference for Bugs model at "/tmp/RtmpCXN5rB/file1ee56c8a902b", fit using jags,</span></span>
<span><span class="co">#&gt;  3 chains, each with 50000 iterations (first 25000 discarded), n.thin = 25</span></span>
<span><span class="co">#&gt;  n.sims = 3000 iterations saved</span></span>
<span><span class="co">#&gt;           mu.vect  sd.vect    2.5%     25%     50%     75%   97.5%  Rhat n.eff</span></span>
<span><span class="co">#&gt; d[1]        0.000    0.000   0.000   0.000   0.000   0.000   0.000 1.000     1</span></span>
<span><span class="co">#&gt; d[2]        0.030    0.082  -0.127  -0.025   0.029   0.086   0.194 1.002  1100</span></span>
<span><span class="co">#&gt; d[3]       -0.072    0.080  -0.233  -0.125  -0.071  -0.019   0.082 1.002  1300</span></span>
<span><span class="co">#&gt; d[4]       -0.231    0.083  -0.396  -0.287  -0.233  -0.176  -0.068 1.001  3000</span></span>
<span><span class="co">#&gt; d[5]       -0.087    0.067  -0.224  -0.132  -0.086  -0.040   0.041 1.001  2100</span></span>
<span><span class="co">#&gt; d[6]        0.418    0.186   0.057   0.294   0.418   0.542   0.785 1.003  1700</span></span>
<span><span class="co">#&gt; totresdev 152.092 1263.906  92.815 102.985 109.098 115.891 131.814 1.001  3000</span></span>
<span><span class="co">#&gt; deviance  457.792 1263.906 398.515 408.685 414.797 421.591 437.513 1.001  3000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size,</span></span>
<span><span class="co">#&gt; and Rhat is the potential scale reduction factor (at convergence, Rhat=1).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIC info (using the rule, pD = var(deviance)/2)</span></span>
<span><span class="co">#&gt; pD = 41.4 and DIC = 456.1</span></span>
<span><span class="co">#&gt; DIC is an estimate of expected predictive error (lower deviance is better).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $trt.labs</span></span>
<span><span class="co">#&gt; [1] "Placebo_0"  "ICS_1"      "LABA_1"     "LABA-ICS_1" "TIO-HH_1"  </span></span>
<span><span class="co">#&gt; [6] "TIO-SMI_1" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $UME</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "nma"</span></span></code></pre></div>
<p>We can also show the equivalence of results using
<code><a href="../reference/get.relative.html">get.relative()</a></code> to compare relative effects from both
models:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.relative.html">get.relative</a></span><span class="op">(</span><span class="va">nma.linear</span>, <span class="va">nma</span><span class="op">)</span></span></code></pre></div>
<p>Without a placebo, estimation is very similar, but requires renaming
and recoding the network reference intervention to
<code>"Placebo"</code>. This is not strictly necessary, as
<code>MBNMAdose</code> can handle dose-response datasets that do not
include placebo (or dose=0), but it will ensure that parameter estimates
are equivalent between the NMA and MBNMA models and will make it easier
to estimate relative effects. We illustrate this with the Surgical Site
Infection dataset.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure that Suture-absorbable is the network reference</span></span>
<span><span class="va">ssi</span> <span class="op">&lt;-</span> <span class="va">ssi_closure</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>agent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Suture-absorbable"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ssi_closure</span><span class="op">$</span><span class="va">trt</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set dose=0 for network reference and dose=1 for all other interventions</span></span>
<span><span class="va">ssi.plac</span> <span class="op">&lt;-</span> <span class="va">ssi</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trt</span> <span class="op">==</span> <span class="st">"Suture-absorbable"</span> <span class="op">~</span> <span class="fl">0</span>, <span class="cn">TRUE</span> <span class="op">~</span></span>
<span>        <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">network.plac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.network.html">mbnma.network</a></span><span class="op">(</span><span class="va">ssi.plac</span><span class="op">)</span></span>
<span><span class="co">#&gt; Values for `agent` with dose = 0 have been recoded to `Placebo`</span></span>
<span><span class="co">#&gt; agent is being recoded to enforce sequential numbering</span></span>
<span><span class="co">#&gt; Values for `class` with dose = 0 have been recoded to `Placebo`</span></span>
<span><span class="co">#&gt; class is being recoded to enforce sequential numbering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network.plac</span><span class="op">)</span></span></code></pre></div>
<p><img src="nma_in_mbnmadose_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that Suture-absorbable (the comparator) has been renamed to Placebo</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run linear MBNMA model</span></span>
<span><span class="va">nma.linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.run.html">mbnma.run</a></span><span class="op">(</span><span class="va">network.plac</span>, fun <span class="op">=</span> <span class="fu"><a href="../reference/dpoly.html">dpoly</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, n.iter <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="co">#&gt; `likelihood` not given by user - set to `binomial` based on data provided</span></span>
<span><span class="co">#&gt; `link` not given by user - set to `logit` based on assigned value for `likelihood`</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nma.linear</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Dose-response MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Likelihood: binomial</span></span>
<span><span class="co">#&gt; Link function: logit</span></span>
<span><span class="co">#&gt; Dose-response function: poly</span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; Pooling method</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: Common (fixed) effects estimated for relative effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent                               |Parameter  |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:-----------------------------------|:----------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |Clips                               |beta.1[2]  | -0.1120| -1.0326|  0.7574|</span></span>
<span><span class="co">#&gt; |Suture--monofilament                |beta.1[3]  |  0.0167| -0.8238|  0.8355|</span></span>
<span><span class="co">#&gt; |Staples                             |beta.1[4]  |  0.0350| -0.5538|  0.6412|</span></span>
<span><span class="co">#&gt; |Suture                              |beta.1[5]  | -0.0536| -0.7231|  0.6402|</span></span>
<span><span class="co">#&gt; |Tissue adhesive gel-low viscosity   |beta.1[6]  |  0.6735| -0.0366|  1.4312|</span></span>
<span><span class="co">#&gt; |Tape/film                           |beta.1[7]  | -0.3073| -1.0275|  0.3701|</span></span>
<span><span class="co">#&gt; |Preference of physician             |beta.1[8]  | -0.2471| -1.5692|  0.9822|</span></span>
<span><span class="co">#&gt; |Tissue adhesive gel-high viscosity  |beta.1[9]  | -0.2008| -1.8347|  1.5226|</span></span>
<span><span class="co">#&gt; |Suture-non-absorbable               |beta.1[10] | -0.1038| -0.3832|  0.1728|</span></span>
<span><span class="co">#&gt; |Suture-antimicrobial                |beta.1[11] | -0.2729| -0.4218| -0.1146|</span></span>
<span><span class="co">#&gt; |Suture-non-absorbable-monofilament  |beta.1[12] | -0.6355| -1.2814| -0.0301|</span></span>
<span><span class="co">#&gt; |Suture-absorbable-monofilament      |beta.1[13] | -0.5063| -1.1663|  0.1380|</span></span>
<span><span class="co">#&gt; |Tissue adhesive gel                 |beta.1[14] |  0.9460| -1.7226|  4.5044|</span></span>
<span><span class="co">#&gt; |Suture-absorbable-multifilament     |beta.1[15] | -0.7516| -1.4183| -0.0981|</span></span>
<span><span class="co">#&gt; |Suture-non-absorbable-multifilament |beta.1[16] | -1.0334| -1.9207| -0.1201|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Model Fit Statistics</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD calculated using the Kullback-Leibler divergence = 114.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance = 1017.1</span></span>
<span><span class="co">#&gt; Residual deviance = 288.2</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 1131.5</span></span></code></pre></div>
<p>The linear dose-response coefficients can then be interpreted as the
relative effect for each intervention versus the network reference
(<code>"Suture-absorbable"</code>).</p>
</div>
<div class="section level2">
<h2 id="benefits-of-using-mbnma-run-for-standard-nma-models">Benefits of using <code>mbnma.run()</code> for standard NMA
models<a class="anchor" aria-label="anchor" href="#benefits-of-using-mbnma-run-for-standard-nma-models"></a>
</h2>
<p>Now that we have shown how to specify a standard NMA model within the
MBNMA framework in <code><a href="../reference/mbnma.run.html">mbnma.run()</a></code>, we can now use
<code>MBNMAdose</code> to implement some more interesting models, such
as class effect models and node-splits to assess consistency.</p>
<p>A class effects model can be implemented using the
<code>class.effect</code> argument in <code><a href="../reference/mbnma.run.html">mbnma.run()</a></code>,
introducing either a <code>"common"</code> or 2 class effect on the
single linear dose-response parameter, <code>beta.1</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random class effect model</span></span>
<span><span class="va">nma.class</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.run.html">mbnma.run</a></span><span class="op">(</span><span class="va">network.plac</span>, fun <span class="op">=</span> <span class="fu"><a href="../reference/dpoly.html">dpoly</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, class.effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta.1 <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span>,</span>
<span>    n.iter <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span></code></pre></div>
<p>A <code>"common"</code> class effect assumes that all treatments
within a class have the same effect, whilst a <code>"random"</code>
class effect assumes that treatment-level effects are randomly
distributed around a mean class effect with a standard deviation (SD)
that is estimated within the model.</p>
<p>Common and random class effect models can be compared using model fit
statistics (e.g. Deviance Information Criterion) to identify which is
the most parsimonious model. Note that within <code>MBNMAdose</code>
when a random class effect is fitted this makes the assumption that all
classes share the same within-class SD. This may not necessarily be
valid, but relaxing this cannot currently be done in
<code>MBNMAdose</code> and it requires specific JAGS code to be
written.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hugo Pedder.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
