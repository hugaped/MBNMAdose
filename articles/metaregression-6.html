<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MBNMAdose: Perform Network Meta-Regression • MBNMAdose</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MBNMAdose: Perform Network Meta-Regression">
<meta property="og:description" content="MBNMAdose">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MBNMAdose</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/consistencychecking-3.html">MBNMAdose: Checking for consistency</a>
    </li>
    <li>
      <a href="../articles/dataexploration-1.html">MBNMAdose: Exploring the data</a>
    </li>
    <li>
      <a href="../articles/mbnmadose-overview.html">MBNMAdose: Package Overview</a>
    </li>
    <li>
      <a href="../articles/metaregression-6.html">MBNMAdose: Perform Network Meta-Regression</a>
    </li>
    <li>
      <a href="../articles/nma_in_mbnmadose.html">Class effect NMA analysis using MBNMAdose</a>
    </li>
    <li>
      <a href="../articles/outputs-4.html">MBNMAdose outputs: Relative effects, forest plots and rankings</a>
    </li>
    <li>
      <a href="../articles/predictions-5.html">MBNMAdose: Calculating model predictions</a>
    </li>
    <li>
      <a href="../articles/runmbnmadose-2.html">MBNMAdose: Perform a Model-Based Network Meta-Analysis (MBNMA)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MBNMAdose: Perform Network Meta-Regression</h1>
                        <h4 data-toc-skip class="author">Hugo
Pedder</h4>
            
            <h4 data-toc-skip class="date">2024-07-03</h4>
      
      
      <div class="hidden name"><code>metaregression-6.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="network-meta-regression">Network meta-regression<a class="anchor" aria-label="anchor" href="#network-meta-regression"></a>
</h2>
<p>Study-level covariates can be included in the model to adjust
treatment effects following an approach for meta-regression outlined in
NICE Technical Support Document 3 <span class="citation">(Dias et al.
2011)</span>. This can be used to explore and account for potential
effect modification.</p>
<p>Following the definition in NICE Technical Support Document 3,
network meta-regression can be expressed as an interaction on the
treatment effect in arms <span class="math inline">\(\geq2\)</span>:</p>
<p><span class="math display">\[\theta_{i,k}=\mu_i+(f(x,\beta_{a_{i,k}})-f(x,\beta_{a_{i,1}}))
+ (\psi_{1,a_{i,k}}-\psi_{1,a_{i,1}})\]</span></p>
<p>where <span class="math inline">\(\theta_{i,k}\)</span> is the linear
predictor, <span class="math inline">\(\mu_{i}\)</span> is the baseline
effect on arm 1, <span class="math inline">\(f(x,\beta_{a_{i,k}})\)</span> is the dose-response
function at dose <span class="math inline">\(x\)</span> with
dose-response parameters <span class="math inline">\(\beta_{a_{i,k}}\)</span> for agent <span class="math inline">\(a\)</span> in arm <span class="math inline">\(k\)</span> of study <span class="math inline">\(i\)</span>. <span class="math inline">\(\psi_{1,a_{i,k}}\)</span> is then the effect
modifying interaction between the agent in arm <span class="math inline">\(k\)</span> and the network reference agent
(typically Placebo in a dose-response analysis).</p>
<div class="section level3">
<h3 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>To improve estimation:</p>
<ul>
<li>continuous covariates should be centred around their mean</li>
<li>binary/categorical variables should be recoded with the most
commonly reported value as the reference category</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the SSRI dataset</span></span>
<span><span class="va">ssri.reg</span> <span class="op">&lt;-</span> <span class="va">ssri</span></span>
<span></span>
<span><span class="co"># For a continuous covariate</span></span>
<span><span class="va">ssri.reg</span> <span class="op">&lt;-</span> <span class="va">ssri.reg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x.weeks <span class="op">=</span> <span class="va">weeks</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">weeks</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For a categorical covariate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ssri</span><span class="op">$</span><span class="va">weeks</span><span class="op">)</span>  <span class="co"># Using 8 weeks as the reference</span></span>
<span><span class="va">ssri.reg</span> <span class="op">&lt;-</span> <span class="va">ssri.reg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>r.weeks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">weeks</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create network object</span></span>
<span><span class="va">ssrinet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.network.html">mbnma.network</a></span><span class="op">(</span><span class="va">ssri.reg</span><span class="op">)</span></span>
<span><span class="co">#&gt; Values for `agent` with dose = 0 have been recoded to `Placebo`</span></span>
<span><span class="co">#&gt; agent is being recoded to enforce sequential numbering</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modelling">Modelling<a class="anchor" aria-label="anchor" href="#modelling"></a>
</h3>
<p>For performing network meta-regression, different assumptions can be
made regarding how the effect modification may be shared across
agents:</p>
<div class="section level4">
<h4 id="independent-agent-specific-interactions">Independent, agent-specific interactions<a class="anchor" aria-label="anchor" href="#independent-agent-specific-interactions"></a>
</h4>
<p>The least constraining assumption available in <code>MBNMAdose</code>
is to assume that the effect modifier acts on each agent independently,
and separate <span class="math inline">\(\psi_{1,a_{i,k}}\)</span> are
therefore estimated for each agent in the network.</p>
<p>A slightly stronger assumption is to assume that agents within the
same class share the same interaction effect, though classes must be
specified within the dataset for this.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regress for continuous weeks Separate effect modification for each agent vs</span></span>
<span><span class="co"># Placebo</span></span>
<span><span class="va">ssrimod.a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.run.html">mbnma.run</a></span><span class="op">(</span><span class="va">ssrinet</span>, fun <span class="op">=</span> <span class="fu"><a href="../reference/dfpoly.html">dfpoly</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, regress <span class="op">=</span> <span class="op">~</span><span class="va">x.weeks</span>, regress.effect <span class="op">=</span> <span class="st">"agent"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ssrimod.a</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Dose-response MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Likelihood: binomial</span></span>
<span><span class="co">#&gt; Link function: logit</span></span>
<span><span class="co">#&gt; Dose-response function: fpoly</span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; Pooling method</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: Common (fixed) effects estimated for relative effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:---------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |citalopram   |beta.1[2] | -0.0921| -0.3599|  0.1623|</span></span>
<span><span class="co">#&gt; |escitalopram |beta.1[3] |  0.1329| -0.1286|  0.4042|</span></span>
<span><span class="co">#&gt; |fluoxetine   |beta.1[4] |  0.2717|  0.0467|  0.5046|</span></span>
<span><span class="co">#&gt; |paroxetine   |beta.1[5] | -0.1404| -0.4415|  0.1613|</span></span>
<span><span class="co">#&gt; |sertraline   |beta.1[6] |  1.3226| -7.8854| 10.3403|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.2 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:---------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |citalopram   |beta.2[2] |  0.0668| -0.0030|  0.1408|</span></span>
<span><span class="co">#&gt; |escitalopram |beta.2[3] | -0.0076| -0.0966|  0.0737|</span></span>
<span><span class="co">#&gt; |fluoxetine   |beta.2[4] | -0.0665| -0.1327| -0.0002|</span></span>
<span><span class="co">#&gt; |paroxetine   |beta.2[5] |  0.0916| -0.0022|  0.1841|</span></span>
<span><span class="co">#&gt; |sertraline   |beta.2[6] | -0.1820| -1.1618|  0.8251|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">power.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">power.2 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Meta-regression</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Covariates interacting with study-level relative effects: <span style="font-weight: bold;">x.weeks</span></span></span>
<span><span class="co">#&gt; Common (identical) covariate-by-agent effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter    |  Median|     2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:------------|-------:|--------:|-------:|</span></span>
<span><span class="co">#&gt; |citalopram   |B.x.weeks[2] | -0.1579|  -0.3352|  0.0079|</span></span>
<span><span class="co">#&gt; |escitalopram |B.x.weeks[3] |  0.1601|  -0.0319|  0.3592|</span></span>
<span><span class="co">#&gt; |fluoxetine   |B.x.weeks[4] | -0.0264|  -0.1687|  0.1166|</span></span>
<span><span class="co">#&gt; |paroxetine   |B.x.weeks[5] |  0.0836|  -0.0252|  0.1947|</span></span>
<span><span class="co">#&gt; |sertraline   |B.x.weeks[6] |  1.4210| -18.0748| 20.5588|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Model Fit Statistics</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD calculated using the Kullback-Leibler divergence = 74.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance = 890.6</span></span>
<span><span class="co">#&gt; Residual deviance = 190.9</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 965.1</span></span></code></pre></div>
<p>Within the output, a separate parameter (named
<code>B.x.weeks[]</code>) has been estimated for each agent that
corresponds to the effect of an additional week of study follow-up on
the relative effect of the agent versus Placebo. Note that due to the
inclusion of weeks as a continuous covariate, we are assuming a linear
effect modification due to study follow-up.</p>
</div>
<div class="section level4">
<h4 id="random-effect-interaction">Random effect interaction<a class="anchor" aria-label="anchor" href="#random-effect-interaction"></a>
</h4>
<p>Alternatively, the effect modification for different agents versus
the network reference agent can be assumed to be exchangeable/shared
across the network about a common mean, <span class="math inline">\(\hat{\psi}\)</span>, with a between-agent standard
deviation of <span class="math inline">\(\tau_\psi\)</span>:</p>
<p><span class="math display">\[\psi_{1,a_{i,k}} \sim N(\hat{\psi},
\tau^2_\psi)\]</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regress for continuous weeks Random effect modification across all agents vs</span></span>
<span><span class="co"># Placebo</span></span>
<span><span class="va">ssrimod.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.run.html">mbnma.run</a></span><span class="op">(</span><span class="va">ssrinet</span>, fun <span class="op">=</span> <span class="fu"><a href="../reference/dfpoly.html">dfpoly</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, regress <span class="op">=</span> <span class="op">~</span><span class="va">x.weeks</span>, regress.effect <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ssrimod.r</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Dose-response MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Likelihood: binomial</span></span>
<span><span class="co">#&gt; Link function: logit</span></span>
<span><span class="co">#&gt; Dose-response function: fpoly</span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; Pooling method</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: Common (fixed) effects estimated for relative effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter |  Median|    2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:---------|-------:|-------:|------:|</span></span>
<span><span class="co">#&gt; |citalopram   |beta.1[2] | -0.0713| -0.6202| 0.2088|</span></span>
<span><span class="co">#&gt; |escitalopram |beta.1[3] |  0.2440| -0.0324| 0.5390|</span></span>
<span><span class="co">#&gt; |fluoxetine   |beta.1[4] |  0.2659|  0.0253| 0.5325|</span></span>
<span><span class="co">#&gt; |paroxetine   |beta.1[5] | -0.0938| -0.4674| 0.1843|</span></span>
<span><span class="co">#&gt; |sertraline   |beta.1[6] |  0.6658|  0.1637| 1.1718|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.2 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:---------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |citalopram   |beta.2[2] |  0.0637| -0.0133|  0.2148|</span></span>
<span><span class="co">#&gt; |escitalopram |beta.2[3] | -0.0365| -0.1378|  0.0599|</span></span>
<span><span class="co">#&gt; |fluoxetine   |beta.2[4] | -0.0628| -0.1415|  0.0070|</span></span>
<span><span class="co">#&gt; |paroxetine   |beta.2[5] |  0.0813| -0.0070|  0.2025|</span></span>
<span><span class="co">#&gt; |sertraline   |beta.2[6] | -0.1147| -0.2209| -0.0087|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">power.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">power.2 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Meta-regression</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Covariates interacting with study-level relative effects: <span style="font-weight: bold;">x.weeks</span></span></span>
<span><span class="co">#&gt; Random (exchangeable) covariate-by-treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Regression effect |Parameter | Median|    2.5%| 97.5%|</span></span>
<span><span class="co">#&gt; |:-----------------|:---------|------:|-------:|-----:|</span></span>
<span><span class="co">#&gt; |Random effect     |B.x.weeks | 0.0303| -0.0661| 0.126|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard deviation for random covariate-by-treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Parameter    | Median|   2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:------------|------:|------:|------:|</span></span>
<span><span class="co">#&gt; |sd.B.x.weeks | 0.0616| 0.0052| 0.2759|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Model Fit Statistics</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD calculated using the Kullback-Leibler divergence = 76.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance = 890.5</span></span>
<span><span class="co">#&gt; Residual deviance = 190.8</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 967.3</span></span></code></pre></div>
<p>In this case only a single regression paramter is estimated
(<code>B.x.weeks</code>), which corresponds to the mean effect of an
additional week of study follow-up on the relative effect of an active
agent versus Placebo. A parameter is also estimated for the
between-agent standard deviation, <code>sd.B.x.weeks</code>.</p>
</div>
<div class="section level4">
<h4 id="common-effect-interaction">Common effect interaction<a class="anchor" aria-label="anchor" href="#common-effect-interaction"></a>
</h4>
<p>This is the strongest assumption for network meta-regression, and it
implies that effect modification is common (equal) for all agents versus
the network reference agent:</p>
<p><span class="math display">\[\psi_{1,a_{i,k}}
=\hat{\psi}\]</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regress for categorical weeks Common effect modification across all agents vs</span></span>
<span><span class="co"># Placebo</span></span>
<span><span class="va">ssrimod.c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mbnma.run.html">mbnma.run</a></span><span class="op">(</span><span class="va">ssrinet</span>, fun <span class="op">=</span> <span class="fu"><a href="../reference/dfpoly.html">dfpoly</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, regress <span class="op">=</span> <span class="op">~</span><span class="va">r.weeks</span>, regress.effect <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ssrimod.c</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Dose-response MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span>Likelihood: binomial</span></span>
<span><span class="co">#&gt; Link function: logit</span></span>
<span><span class="co">#&gt; Dose-response function: fpoly</span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; Pooling method</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: Common (fixed) effects estimated for relative effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter |  Median|    2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:---------|-------:|-------:|------:|</span></span>
<span><span class="co">#&gt; |citalopram   |beta.1[2] | -0.0628| -0.3399| 0.2093|</span></span>
<span><span class="co">#&gt; |escitalopram |beta.1[3] |  0.2481|  0.0192| 0.4808|</span></span>
<span><span class="co">#&gt; |fluoxetine   |beta.1[4] |  0.2229| -0.0216| 0.4693|</span></span>
<span><span class="co">#&gt; |paroxetine   |beta.1[5] | -0.1125| -0.4094| 0.1988|</span></span>
<span><span class="co">#&gt; |sertraline   |beta.1[6] |  0.5900|  0.1250| 1.0481|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.2 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects for each agent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Agent        |Parameter |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:------------|:---------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |citalopram   |beta.2[2] |  0.0582| -0.0136|  0.1321|</span></span>
<span><span class="co">#&gt; |escitalopram |beta.2[3] | -0.0277| -0.1093|  0.0516|</span></span>
<span><span class="co">#&gt; |fluoxetine   |beta.2[4] | -0.0569| -0.1254|  0.0099|</span></span>
<span><span class="co">#&gt; |paroxetine   |beta.2[5] |  0.0860| -0.0111|  0.1815|</span></span>
<span><span class="co">#&gt; |sertraline   |beta.2[6] | -0.1020| -0.1954| -0.0082|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">power.1 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">power.2 dose-response parameter results</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Meta-regression</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Covariates interacting with study-level relative effects: <span style="font-weight: bold;">r.weeks4</span>, <span style="font-weight: bold;">r.weeks5</span>, <span style="font-weight: bold;">r.weeks6</span>, <span style="font-weight: bold;">r.weeks9</span>, <span style="font-weight: bold;">r.weeks10</span></span></span>
<span><span class="co">#&gt; Common (identical) covariate-by-treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Regression effect |Parameter   |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:-----------------|:-----------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |Common effect     |B.r.weeks10 |  0.1430| -0.2404|  0.5346|</span></span>
<span><span class="co">#&gt; |Common effect     |B.r.weeks4  | -0.7304| -1.4727| -0.0153|</span></span>
<span><span class="co">#&gt; |Common effect     |B.r.weeks5  |  0.7975| -0.2289|  1.8614|</span></span>
<span><span class="co">#&gt; |Common effect     |B.r.weeks6  |  0.0516| -0.1362|  0.2388|</span></span>
<span><span class="co">#&gt; |Common effect     |B.r.weeks9  |  0.4311| -0.3775|  1.2280|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Model Fit Statistics</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD calculated using the Kullback-Leibler divergence = 74.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance = 890.9</span></span>
<span><span class="co">#&gt; Residual deviance = 191.2</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 965.7</span></span></code></pre></div>
<p>In this case we have performed the network meta-regression on study
follow-up (weeks) as a categorical covariate. Therefore, although only a
single parameter is estimated for each effect modifying term, there is a
separate term for each category of week and a linear relationship for
effect modification is no longer assumed.</p>
</div>
<div class="section level4">
<h4 id="alternative-assumptions">Alternative assumptions<a class="anchor" aria-label="anchor" href="#alternative-assumptions"></a>
</h4>
<p>Although this is beyond the capability of <code>MBNMAdose</code>, one
could envision a more complex model in which the interaction effect also
varied by a dose-response relationship, rather than assuming an effect
by agent/class or across the whole network. This would in principle
contain fewer parameters than a fully independent interaction model (in
which a separate regression covariate is estimated for each treatment in
the dataset).</p>
</div>
<div class="section level4">
<h4 id="aggregation-bias">Aggregation bias<a class="anchor" aria-label="anchor" href="#aggregation-bias"></a>
</h4>
<p>Note that adjusting for aggregated patient-level covariates
(e.g. mean age, % males, etc.) whilst using a non-identity link function
can introduce aggregation bias. This is a form of ecological bias that
biases treatment effects towards the null and is typically more severe
where treatment effects are strong and where the link function is highly
non-linear <span class="citation">(Dias et al. 2011)</span>. This can be
resolved by performing a patient-level regression, but Individual
Participant Data are required for this and such an analysis is outside
the scope of <code>MBNMAdose</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="prediction-using-effect-modifying-covariates">Prediction using effect modifying covariates<a class="anchor" aria-label="anchor" href="#prediction-using-effect-modifying-covariates"></a>
</h3>
<p>Models fitted with meta-regression can also be used to make
predictions for a specified set of covariate values. This includes when
estimating relative effects using <code><a href="../reference/get.relative.html">get.relative()</a></code>. An
additional argument <code>regress.vals</code> can be used to provide a
named vector of covariate values at which to make predictions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For a continuous covariate, make predictions at 5 weeks follow-up</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ssrimod.a</span>, regress.vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x.weeks <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><img src="metaregression-6_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Predictions are very uncertain for Sertraline, as studies only
investigated this agent at 6 weeks follow-up and therefore the
agent-specific effect modification is very poorly estimated.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For a categorical covariate, make predictions at 10 weeks follow-up</span></span>
<span><span class="va">regress.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r.weeks10 <span class="op">=</span> <span class="fl">1</span>, r.weeks4 <span class="op">=</span> <span class="fl">0</span>, r.weeks5 <span class="op">=</span> <span class="fl">0</span>, r.weeks6 <span class="op">=</span> <span class="fl">0</span>, r.weeks9 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ssrimod.c</span>, regress.vals <span class="op">=</span> <span class="va">regress.p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><img src="metaregression-6_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Note that categorical covariates are modelled as multiple binary
dummy covariates, and so a value for each of these must be included.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-TSD3" class="csl-entry">
Dias, S., A. J. Sutton, N. J. Welton, and A. E. Ades. 2011. <span>“NICE
DSU Technical Support Document 3: Heterogeneity: Subgroups,
Meta-Regression, Bias and Bias, Adjustment.”</span> Decision Support
Unit, ScHARR, University of Sheffield. <a href="https://www.ncbi.nlm.nih.gov/books/NBK395886/pdf/Bookshelf_NBK395886.pdf" class="external-link">https://www.ncbi.nlm.nih.gov/books/NBK395886/pdf/Bookshelf_NBK395886.pdf</a>.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hugo Pedder.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
